<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>NJmetro The-Next-Train</title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <!-- 导航栏 -->
    <div class="navbar">
        <!-- 左侧导航按钮 -->
        <a href="about.html" target="_self">About</a>
        <a href="index.html" target="_self">中文/Chinese</a>

        <!-- 右侧图片占位符 -->
        <img src="placeholder.png" alt="">
    </div>

    <h1 style="text-align: center; color: orange; margin-bottom: 30px; font-family: SimHei">NJ metro The-Next-Train</h1>

     <div class="news-ticker">
        <span id="ticker-text">Line 5 Wenjing Road Station - Fangjiaying Station is not yet open.&nbsp;&nbsp;&nbsp;&nbsp;Line 6 from Nanjing South Railway Station to Qixia Mountain Station is not yet open.</span>
        <div class="dropdown-arrow" onclick="toggleNewsExpansion()">▼</div>
        <div class="expanded-news">
            <div class="news-content">
                <div class="news-page active">
                    <h3>停运通知</h3>
                    <p>Line 5 Wenjing Road Station - Fangjiaying Station is not yet open.</p>
                </div>
                <div class="news-page">
                    <h3>停运通知</h3>
                    <p>Line 6 from Nanjing South Railway Station to Qixia Mountain Station is not yet open.</p>
                </div>
                <div class="news-page">
                    <h3>News 3</h3>
                    <p>Content 3</p>
                </div>
            </div>
            <div class="news-controls">
                <button class="news-prev" onclick="prevNewsPage()">←</button>
                <p class="page-indicator">1/3</p>
                <button class="news-next" onclick="nextNewsPage()">→</button>
            </div>
        </div>
    </div>

    <div class="search-box">
        <input
            type="text"
            id="stationInput"
            placeholder="Please input the station name.  example:XINJIEKOU/xjk"
            oninput="showSuggestions(this.value)"
            onclick="showSuggestions(this.value)"
            onkeydown="if (event.key == 'Enter') { document.getElementById('stationInput').value = firstStation; searchStation(); }"
        >
        <button onclick="searchStation()">Search</button>
    </div>
    <div id="autocomplete-list" class="autocomplete-items"></div>
    <div id="result" class="result"></div>
    <div id="lineInfo"></div>

    <script src="./translationdata.js"></script>
    <script src="./js/stationdata.js"></script>
    <script src="./pinyinpro.min.js"></script>
    <script src="./timetable.js"></script>
    <script src="./search.js"></script>


    <script>
        const translation_en_zh = new Map();
        for (i of translation){
        translation_en_zh.set(i.en,i.zh);
        }
        const translation_zh_en = new Map();
        for (i of translation){
        translation_zh_en.set(i.zh,i.en);
        }
        function zh_to_en(str) {
        v = translation_zh_en.get(str);
        if (v == undefined) return str;
        else return v;
        }
        
       let currentNewsPage = 0;
        let totalNewsPages = 3;

        function toggleNewsExpansion() {
            const ticker = document.querySelector('.news-ticker');
            const expanded = document.querySelector('.expanded-news');
            const overlay = document.querySelector('.blur-overlay');

            if (ticker.classList.contains('expanded')) {
                ticker.classList.remove('expanded');
                expanded.style.display = 'none';
                overlay.style.display = 'none';
            } else {
                ticker.classList.add('expanded');
                expanded.style.display = 'block';
                overlay.style.display = 'block';
                updatePageIndicator();
            }
        }

        function prevNewsPage() {
            if (currentNewsPage > 0) {
                currentNewsPage--;
                showNewsPage(currentNewsPage);
            }
        }

        function nextNewsPage() {
            if (currentNewsPage < totalNewsPages - 1) {
                currentNewsPage++;
                showNewsPage(currentNewsPage);
            }
        }

        function showNewsPage(pageIndex) {
            const pages = document.querySelectorAll('.news-page');
            pages.forEach((page, index) => {
                if (index === pageIndex) {
                    page.classList.add('active');
                } else {
                    page.classList.remove('active');
                }
            });
            updatePageIndicator();
        }

        function updatePageIndicator() {
            const indicator = document.querySelector('.page-indicator');
            indicator.textContent = `${currentNewsPage + 1}/${totalNewsPages}`;
        }
    </script>

    <div class="blur-overlay"></div>
</body>
</html>